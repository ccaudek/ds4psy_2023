

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. Introduzione a Pandas &#8212; ds4p23</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '025_intro_pandas';</script>
    <link rel="canonical" href="https://ccaudek.github.io/ds4psy_2023/025_intro_pandas.html" />
    <link rel="shortcut icon" href="_static/increasing.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Riepilogo dei dati con Pandas" href="026_pandas_aggregate.html" />
    <link rel="prev" title="4. Introduzione a Numpy" href="020_intro_numpy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="preface.html">1. Prefazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_installation.html">2. Ambiente di lavoro</a></li>
<li class="toctree-l1"><a class="reference internal" href="015_intro_python.html">3. Introduzione a Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="020_intro_numpy.html">4. Introduzione a Numpy</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Introduzione a Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="026_pandas_aggregate.html">6. Riepilogo dei dati con Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="035_intro_matplotlib.html">7. Introduzione a Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="040_intro_seaborn.html">8. Introduzione a Seaborn</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistica descrittiva</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="051_key_notions.html">9. Concetti chiave</a></li>
<li class="toctree-l1"><a class="reference internal" href="055_measurement.html">10. La misurazione in psicologia</a></li>
<li class="toctree-l1"><a class="reference internal" href="060_freq_distr.html">11. Dati e frequenze</a></li>
<li class="toctree-l1"><a class="reference internal" href="065_loc_scale.html">12. Indici di posizione e di scala</a></li>
<li class="toctree-l1"><a class="reference internal" href="070_correlation.html">13. Le relazioni tra variabili</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Probabilità</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="100_sets.html">14. Insiemi</a></li>
<li class="toctree-l1"><a class="reference internal" href="105_combinatorics.html">15. Calcolo combinatorio</a></li>
<li class="toctree-l1"><a class="reference internal" href="110_intro_prob.html">16. Introduzione al calcolo delle probabilità</a></li>
<li class="toctree-l1"><a class="reference internal" href="111_prob_tutorial.html">17. Esercizi di probabilità discreta</a></li>
<li class="toctree-l1"><a class="reference internal" href="115_conditional_prob.html">18. Probabilità condizionata</a></li>
<li class="toctree-l1"><a class="reference internal" href="120_bayes_theorem.html">19. Il teorema di Bayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="125_expval_var.html">20. Variabili casuali</a></li>
<li class="toctree-l1"><a class="reference internal" href="130_joint_prob.html">21. Probabilità congiunta</a></li>
<li class="toctree-l1"><a class="reference internal" href="135_density_func.html">22. La funzione di densità di probabilità</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Distribuzioni di v.c.</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="205_discr_rv_distr.html">23. Distribuzioni di v.c. discrete</a></li>
<li class="toctree-l1"><a class="reference internal" href="210_cont_rv_distr.html">24. Distribuzioni di v.c. continue</a></li>
<li class="toctree-l1"><a class="reference internal" href="215_rng.html">25. Generazione di numeri casuali</a></li>
<li class="toctree-l1"><a class="reference internal" href="225_likelihood.html">26. La verosimiglianza</a></li>
<li class="toctree-l1"><a class="reference internal" href="226_rescorla_wagner.html">27. Apprendimento per rinforzo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Inferenza bayesiana</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="305_intro_bayes.html">28. Credibilità, modelli e parametri</a></li>
<li class="toctree-l1"><a class="reference internal" href="310_subj_prop.html">29. Inferenza su una proporzione</a></li>
<li class="toctree-l1"><a class="reference internal" href="316_conjugate_families.html">30. Distribuzioni coniugate</a></li>
<li class="toctree-l1"><a class="reference internal" href="321_balance-prior-post.html">31. L’influenza della distribuzione a priori</a></li>
<li class="toctree-l1"><a class="reference internal" href="325_metropolis.html">32. Approssimazione della distribuzione a posteriori</a></li>
<li class="toctree-l1"><a class="reference internal" href="330_beta_binomial.html">33. Inferenza bayesiana con MCMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="335_mcmc_diagnostics.html">34. Diagnostica delle catene markoviane</a></li>
<li class="toctree-l1"><a class="reference internal" href="340_summarize_posterior.html">35. Sintesi a posteriori</a></li>
<li class="toctree-l1"><a class="reference internal" href="341_example_prop.html">36. Analisi bayesiana dell’odds-ratio</a></li>
<li class="toctree-l1"><a class="reference internal" href="345_bayesian_prediction.html">37. La predizione bayesiana</a></li>
<li class="toctree-l1"><a class="reference internal" href="346_predict_counts.html">38. La predizione delle frequenze</a></li>
<li class="toctree-l1"><a class="reference internal" href="350_normal_normal_mod.html">39. Inferenza bayesiana su una media</a></li>
<li class="toctree-l1"><a class="reference internal" href="355_groups_comparison.html">40. Confronto tra gruppi</a></li>
<li class="toctree-l1"><a class="reference internal" href="356_repeated_measures.html">41. Misure ripetute</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regressione lineare</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="400_reglin_1.html">42. Introduzione</a></li>
<li class="toctree-l1"><a class="reference internal" href="405_reglin_2.html">43. Regressione lineare bivariata</a></li>
<li class="toctree-l1"><a class="reference internal" href="406_reglin_python_tutorial.html">44. Regressione lineare con Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="410_reglin_3.html">45. Regressione lineare con PyMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="415_reglin_4.html">46. Confronto tra le medie di due gruppi</a></li>
<li class="toctree-l1"><a class="reference internal" href="420_reglin_ppc.html">47. Posterior Predictive Checks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Inferenza frequentista</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="500_intro_frequentist.html">48. Introduzione all’inferenza frequentista</a></li>
<li class="toctree-l1"><a class="reference internal" href="505_conf_interv.html">49. Intervallo di confidenza</a></li>
<li class="toctree-l1"><a class="reference internal" href="510_test_ipotesi.html">50. Significatività statistica</a></li>
<li class="toctree-l1"><a class="reference internal" href="514_two_ind_samples.html">51. Test t di Student per campioni indipendenti</a></li>
<li class="toctree-l1"><a class="reference internal" href="516_ttest_exercises.html">52. Esercizi sull’inferenza frequentista</a></li>
<li class="toctree-l1"><a class="reference internal" href="515_limiti_stat_frequentista.html">53. Limiti dell’inferenza frequentista</a></li>
<li class="toctree-l1"><a class="reference internal" href="520_s_m_errors.html">54. Errori di tipo <em>m</em> e <em>s</em></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliografia</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="z_biblio.html">55. Bibliografia</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="a01_math_symbols.html">56. Simbologia di base</a></li>
<li class="toctree-l1"><a class="reference internal" href="a02_number_sets.html">57. Numeri binari, interi, razionali, irrazionali e reali</a></li>
<li class="toctree-l1"><a class="reference internal" href="a04_summation_notation.html">58. Simbolo di somma (sommatorie)</a></li>
<li class="toctree-l1"><a class="reference internal" href="a05_calculus.html">59. Per liberarvi dai terrori preliminari</a></li>
<li class="toctree-l1"><a class="reference internal" href="a06_kde_plot.html">60. Kernel Density plot</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/025_intro_pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduzione a Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">5.1. Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">5.2. DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lettura-di-dati-da-file">5.3. Lettura di dati da file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gestione-dei-dati-mancanti">5.4. Gestione dei dati mancanti</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rinominare-le-colonne">5.5. Rinominare le colonne</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estrarre-i-dati-dal-dataframe">5.6. Estrarre i dati dal DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colonne">5.6.1. Colonne</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#righe">5.6.2. Righe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indicizzazione-selezione-e-filtraggio">5.6.3. Indicizzazione, selezione e filtraggio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrare-righe-in-maniera-condizionale">5.6.4. Filtrare righe in maniera condizionale</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-query">5.6.5. Metodo <code class="docutils literal notranslate"><span class="pre">.query</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selezione-casuale-di-un-sottoinsieme-di-righe">5.7. Selezione casuale di un sottoinsieme di righe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selezione-di-colonne">5.8. Selezione di colonne</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creare-nuove-colonne">5.9. Creare nuove colonne</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formato-long-e-wide">5.10. Formato long e wide</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#watermark">5.11. Watermark</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <a target="_blank" href="https://colab.research.google.com/github/ccaudek/ds4psy_2023/blob/main/025_intro_pandas.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>
<section class="tex2jax_ignore mathjax_ignore" id="introduzione-a-pandas">
<span id="intro-pandas-notebook"></span><h1><span class="section-number">5. </span>Introduzione a Pandas<a class="headerlink" href="#introduzione-a-pandas" title="Permalink to this headline">#</a></h1>
<p>La libreria <a class="reference external" href="https://Pandas.pydata.org/docs/index.html">Pandas</a> è delegata alla gestione e lettura dei dati provenienti da sorgenti eterogenee, tra cui fogli Excel, file CSV, o anche JSON e database di tipo SQL.</p>
<p>Pandas dipenda da due strutture dati principali:</p>
<ul class="simple">
<li><p>la <code class="docutils literal notranslate"><span class="pre">Series</span></code> che viene utilizzata per rappresentare righe o colonne di un DataFrame (molto simile ad un NumPy array),</p></li>
<li><p>il DataFrame, una sorta di tabella, strutturata su colonne dove i dati di ciascuna unità di osservazione sono distribuiti per righe.</p></li>
</ul>
<p>Lo scopo di questo capitolo è iniziare a prendere confidenza con i DataFrame ed imparare a manipolare i dati al loro interno. Per un approfondimento, consiglio il capitolo 10 di <a class="reference external" href="https://wesmckinney.com/book/data-aggregation.html">Python for Data Analysis, 3E</a>.</p>
<p>Iniziamo a caricare le librerie necessarie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statistics</span> <span class="k">as</span> <span class="nn">st</span>
</pre></div>
</div>
</div>
</div>
<section id="series">
<h2><span class="section-number">5.1. </span>Series<a class="headerlink" href="#series" title="Permalink to this headline">#</a></h2>
<p>In Pandas, una <code class="docutils literal notranslate"><span class="pre">Series</span></code> è un array unidimensionale composto da una sequenza di valori omogenei, simile ad un <em>ndarray</em>, accompagnato da un array di etichette chiamato “index”. A differenza degli indici degli array Numpy, che sono sempre interi e partono da zero, gli oggetti <code class="docutils literal notranslate"><span class="pre">Series</span></code> supportano etichette personalizzate che possono essere, ad esempio, delle stringhe. Inoltre, gli oggetti <code class="docutils literal notranslate"><span class="pre">Series</span></code> possono contenere dati mancanti che vengono ignorati da molte delle operazioni della classe.</p>
<p>Il modo più semplice di creare un oggetto <code class="docutils literal notranslate"><span class="pre">Series</span></code> è di convertire una lista. Per esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">27</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">29</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>È possibile ottenere la rappresentazione dell’<code class="docutils literal notranslate"><span class="pre">array</span></code> dell’oggetto e dell’indice dell’oggetto <code class="docutils literal notranslate"><span class="pre">Series</span></code> tramite i suoi attributi <code class="docutils literal notranslate"><span class="pre">array</span></code> e <code class="docutils literal notranslate"><span class="pre">index</span></code>, rispettivamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="o">.</span><span class="n">array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;PandasArray&gt;
[27, 30, 24, 18, 22, 20, 29]
Length: 7, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=7, step=1)
</pre></div>
</div>
</div>
</div>
<p>Oppure, possiamo semplicemente stampare i contenuti dell’oggetto <code class="docutils literal notranslate"><span class="pre">Series</span></code> direttamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    27
1    30
2    24
3    18
4    22
5    20
6    29
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Per accedere agli elementi di un oggetto <code class="docutils literal notranslate"><span class="pre">Series</span></code> si usano le parentesi quadre contenenti un indice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    27
1    30
2    24
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>È possibile filtrare gli elementi di un oggetto <code class="docutils literal notranslate"><span class="pre">Series</span></code> con un array booleano:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span> <span class="o">&gt;</span> <span class="mi">24</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     True
1     True
2    False
3    False
4    False
5    False
6     True
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="p">[</span><span class="n">grades</span> <span class="o">&gt;</span> <span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    27
1    30
6    29
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>È possibile manipolare gli elementi di un oggetto <code class="docutils literal notranslate"><span class="pre">Series</span></code> con le normali operazioni aritmetiche:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span> <span class="o">/</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.7
1    3.0
2    2.4
3    1.8
4    2.2
5    2.0
6    2.9
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    5.196152
1    5.477226
2    4.898979
3    4.242641
4    4.690416
5    4.472136
6    5.385165
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Gli oggetti <code class="docutils literal notranslate"><span class="pre">Series</span></code> hanno diversi metodi per svolgere varie operazioni, per esempio per ricavare alcune statistiche descrittive:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">grades</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="n">grades</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">grades</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">grades</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">grades</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">grades</span><span class="o">.</span><span class="n">sum</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[7, 24.285714285714285, 18, 30, 4.572172558506722, 170]
</pre></div>
</div>
</div>
</div>
<p>Molto utile è il metodo <code class="docutils literal notranslate"><span class="pre">.describe()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     7.000000
mean     24.285714
std       4.572173
min      18.000000
25%      21.000000
50%      24.000000
75%      28.000000
max      30.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataframe">
<h2><span class="section-number">5.2. </span>DataFrame<a class="headerlink" href="#dataframe" title="Permalink to this headline">#</a></h2>
<p>Un <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> è composto da righe e colonne. Ogni colonna di un dataframe è un oggetto <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code>: quindi, un dataframe è una collezione di serie. A differenza di un array NumPy, un dataframe può combinare più tipi di dati, come numeri e testo, ma i dati in ogni colonna sono dello stesso tipo.</p>
<p>Esistono molti modi per costruire un DataFrame. Il più semplice è quello di utilizzare un dizionario che include una o più liste o array Numpy di uguale lunghezza. Per esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Maria&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Anna&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Francesco&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Cristina&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Gianni&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Gabriella&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Stefano&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span>
    <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span>
    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
    <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>group</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Maria</td>
      <td>f</td>
      <td>a</td>
      <td>1</td>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anna</td>
      <td>f</td>
      <td>b</td>
      <td>2</td>
      <td>9</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Francesco</td>
      <td>m</td>
      <td>a</td>
      <td>3</td>
      <td>10</td>
      <td>17</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cristina</td>
      <td>f</td>
      <td>b</td>
      <td>4</td>
      <td>11</td>
      <td>18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Gianni</td>
      <td>m</td>
      <td>b</td>
      <td>5</td>
      <td>12</td>
      <td>19</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gabriella</td>
      <td>f</td>
      <td>c</td>
      <td>6</td>
      <td>13</td>
      <td>20</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Stefano</td>
      <td>m</td>
      <td>a</td>
      <td>7</td>
      <td>14</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Oppure possiamo procedere nel modo seguente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lst1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">lst2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="n">lst3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">14.4</span><span class="p">,</span> <span class="mf">15.1</span><span class="p">,</span> <span class="mf">16.7</span><span class="p">,</span> <span class="mf">17.3</span><span class="p">,</span> <span class="mf">18.9</span><span class="p">,</span> <span class="mf">19.3</span><span class="p">,</span> <span class="mf">20.2</span><span class="p">]</span>
<span class="n">lst4</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">]</span>
<span class="n">lst5</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">]</span>
<span class="n">lst6</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Maria&quot;</span><span class="p">,</span> <span class="s2">&quot;Anna&quot;</span><span class="p">,</span> <span class="s2">&quot;Francesco&quot;</span><span class="p">,</span> <span class="s2">&quot;Cristina&quot;</span><span class="p">,</span> <span class="s2">&quot;Gianni&quot;</span><span class="p">,</span> <span class="s2">&quot;Gabriella&quot;</span><span class="p">,</span> <span class="s2">&quot;Stefano&quot;</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst1</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst2</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst3</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst4</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst5</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst6</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>group</th>
      <th>sex</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8</td>
      <td>14.4</td>
      <td>a</td>
      <td>f</td>
      <td>Maria</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>9</td>
      <td>15.1</td>
      <td>b</td>
      <td>f</td>
      <td>Anna</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>10</td>
      <td>16.7</td>
      <td>a</td>
      <td>m</td>
      <td>Francesco</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>11</td>
      <td>17.3</td>
      <td>b</td>
      <td>f</td>
      <td>Cristina</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>12</td>
      <td>18.9</td>
      <td>b</td>
      <td>m</td>
      <td>Gianni</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>13</td>
      <td>19.3</td>
      <td>c</td>
      <td>f</td>
      <td>Gabriella</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>14</td>
      <td>20.2</td>
      <td>a</td>
      <td>m</td>
      <td>Stefano</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Molto spesso un DataFrame viene creato dal caricamento di dati da file.</p>
</section>
<section id="lettura-di-dati-da-file">
<h2><span class="section-number">5.3. </span>Lettura di dati da file<a class="headerlink" href="#lettura-di-dati-da-file" title="Permalink to this headline">#</a></h2>
<p>Di solito la quantità di dati da analizzare è tale che non è pensabile di poterli immettere manualmente in una o più liste. Normalmente i dati sono memorizzati su un file ed è necessario importarli. La lettura (importazione) dei file è il primo fondamentale passo nel processo più generale di analisi dei dati.</p>
<p>In un primo esempio, importiamo i dati da un repository remoto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/pandas-dev/pandas/master/doc/data/titanic.csv&quot;</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>È possibile usare il metodo <code class="docutils literal notranslate"><span class="pre">.head()</span></code> per visualizzare le prime cinque righe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Braund, Mr. Owen Harris</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>Cumings, Mrs. John Bradley (Florence Briggs Thayer)</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>Heikkinen, Miss. Laina</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>Futrelle, Mrs. Jacques Heath (Lily May Peel)</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>Allen, Mr. William Henry</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Le statistiche descrittive per ciascuna colonna si ottengono con il metodo <code class="docutils literal notranslate"><span class="pre">describe</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <th>std</th>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In questo modo possiamo ottenere informazioni sui nomi dei passeggeri, la sopravvivenza (0 o 1), l’età, il prezzo del biglietto, ecc. Con le statistiche riassuntive vediamo che l’età media è di 29,7 anni, il prezzo massimo del biglietto è di 512 USD, il 38% dei passeggeri è sopravvissuto, ecc.</p>
<p>Supponiamo di essere interessati alla probabilità di sopravvivenza per diverse fasce d’età. Con due righe di codice, possiamo trovare l’età media di coloro che sono sopravvissuti o non sono sopravvissuti e generare gli istogrammi corrispondenti della distribuzione dell’età:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Survived&quot;</span><span class="p">)[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived
0    30.626179
1    28.343690
Name: Age, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span>
    <span class="n">by</span><span class="o">=</span><span class="s2">&quot;Survived&quot;</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&lt;Axes: title={&#39;center&#39;: &#39;0&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;1&#39;}&gt;],
      dtype=object)
</pre></div>
</div>
<img alt="_images/bdfad0adedcf3ca946a8c9237b38e2cd50cc626a13640c7a01313ab0936fd96c.png" src="_images/bdfad0adedcf3ca946a8c9237b38e2cd50cc626a13640c7a01313ab0936fd96c.png" />
</div>
</div>
<p>È chiaro che i dataframes di Pandas ci permettono di condurre analisi avanzate con pochi comandi, ma acquisire familiarità con la sintassi corretta richiede un po’ di tempo.</p>
<p>Per fare un secondo esempio, importo i dati dal file <code class="docutils literal notranslate"><span class="pre">penguins.csv</span></code> situato nella directory “data” del mio computer. I dati relativi ai pinguini di Palmer sono resi disponibili da <a class="reference external" href="https://www.uaf.edu/cfos/people/faculty/detail/kristen-gorman.php">Kristen Gorman</a> e dalla <a class="reference external" href="https://pallter.marine.rutgers.edu/">Palmer station, Antarctica LTER</a>. La seguente cella legge il contenuto del file <code class="docutils literal notranslate"><span class="pre">penguins.csv</span></code> e lo inserisce nell’oggetto <code class="docutils literal notranslate"><span class="pre">df</span></code> utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> di Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/penguins.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Per il DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code> il significato delle colonne è il seguente:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">species</span></code>: a factor denoting penguin type (Adélie, Chinstrap and Gentoo)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">island</span></code>: a factor denoting island in Palmer Archipelago, Antarctica (Biscoe, Dream or Torgersen)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bill_length_mm</span></code>: a number denoting bill length (millimeters)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bill_depth_mm</span></code>: a number denoting bill depth (millimeters)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flipper_length_mm</span></code>: an integer denoting flipper length (millimeters)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body_mass_g</span></code>: an integer denoting body mass (grams)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sex</span></code>: a factor denoting sexuality (female, male)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">year</span></code>: the year of the study</p></li>
</ul>
<p>Usiamo il metodo <code class="docutils literal notranslate"><span class="pre">.head()</span></code> per visualizzare le prime cinque righe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A volte potrebbero esserci dati estranei alla fine del file, quindi è importante anche controllare le ultime righe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>55.8</td>
      <td>19.8</td>
      <td>207.0</td>
      <td>4000.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>43.5</td>
      <td>18.1</td>
      <td>202.0</td>
      <td>3400.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>49.6</td>
      <td>18.2</td>
      <td>193.0</td>
      <td>3775.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.8</td>
      <td>19.0</td>
      <td>210.0</td>
      <td>4100.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.2</td>
      <td>18.7</td>
      <td>198.0</td>
      <td>3775.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Le istruzioni seguenti ritornano le prime e le ultime tre righe del DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>49.6</td>
      <td>18.2</td>
      <td>193.0</td>
      <td>3775.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.8</td>
      <td>19.0</td>
      <td>210.0</td>
      <td>4100.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.2</td>
      <td>18.7</td>
      <td>198.0</td>
      <td>3775.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Un breve tutorial in formato video è disponibile tramite il seguente <a class="reference external" href="https://drive.google.com/file/d/12y7jZ0McvZBXThg6yjFgWx2ljQKrhoYR/view?usp=share_link">collegamento</a>, il quale illustra come effettuare la lettura dei dati da un file esterno in Visual Studio Code.</p>
</div>
<p>L’attributo <code class="docutils literal notranslate"><span class="pre">.dtypes</span></code> restituisce il tipo dei dati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>species               object
island                object
bill_length_mm       float64
bill_depth_mm        float64
flipper_length_mm    float64
body_mass_g          float64
sex                   object
year                   int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Gli attributi più comunemente usati sono elencati di seguito:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Attributo</p></th>
<th class="head"><p>Ritorna</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dtypes</span></code></p></td>
<td><p>Il tipo di dati in ogni colonna</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>Una tupla con le dimensioni del DataFrame object (numero di righe, numero di colonne)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">index</span></code></p></td>
<td><p>L’oggetto <code class="docutils literal notranslate"><span class="pre">Index</span></code> lungo le righe del DataFrame</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">columns</span></code></p></td>
<td><p>Il nome delle colonne</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">values</span></code></p></td>
<td><p>I dati contenuti nel DataFrame</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">empty</span></code></p></td>
<td><p>Check if the DataFrame object is empty</p></td>
</tr>
</tbody>
</table>
<p>Per esempio, l’istruzione della cella seguente restituisce l’elenco con i nomi delle colonne del DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;species&#39;, &#39;island&#39;, &#39;bill_length_mm&#39;, &#39;bill_depth_mm&#39;,
       &#39;flipper_length_mm&#39;, &#39;body_mass_g&#39;, &#39;sex&#39;, &#39;year&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>L’attributo <code class="docutils literal notranslate"><span class="pre">.shape</span></code> ritorna il numero di righe e di colonne del DataFrame. Nel caso presente, ci sono 344 righe e 8 colonne.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(344, 8)
</pre></div>
</div>
</div>
</div>
<p>Come abbiamo già visto in precedenza, un sommario dei dati si ottiene con il metodo <code class="docutils literal notranslate"><span class="pre">.describe()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>342.000000</td>
      <td>342.000000</td>
      <td>342.000000</td>
      <td>342.000000</td>
      <td>344.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>43.921930</td>
      <td>17.151170</td>
      <td>200.915205</td>
      <td>4201.754386</td>
      <td>2008.029070</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.459584</td>
      <td>1.974793</td>
      <td>14.061714</td>
      <td>801.954536</td>
      <td>0.818356</td>
    </tr>
    <tr>
      <th>min</th>
      <td>32.100000</td>
      <td>13.100000</td>
      <td>172.000000</td>
      <td>2700.000000</td>
      <td>2007.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>39.225000</td>
      <td>15.600000</td>
      <td>190.000000</td>
      <td>3550.000000</td>
      <td>2007.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>44.450000</td>
      <td>17.300000</td>
      <td>197.000000</td>
      <td>4050.000000</td>
      <td>2008.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>48.500000</td>
      <td>18.700000</td>
      <td>213.000000</td>
      <td>4750.000000</td>
      <td>2009.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>59.600000</td>
      <td>21.500000</td>
      <td>231.000000</td>
      <td>6300.000000</td>
      <td>2009.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Una descrizione del DataFrame si ottiene con il metodo <code class="docutils literal notranslate"><span class="pre">.info()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 344 entries, 0 to 343
Data columns (total 8 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   species            344 non-null    object 
 1   island             344 non-null    object 
 2   bill_length_mm     342 non-null    float64
 3   bill_depth_mm      342 non-null    float64
 4   flipper_length_mm  342 non-null    float64
 5   body_mass_g        342 non-null    float64
 6   sex                333 non-null    object 
 7   year               344 non-null    int64  
dtypes: float64(4), int64(1), object(3)
memory usage: 21.6+ KB
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Si noti che, alle volte, abbiamo utilizzato la sintassi <code class="docutils literal notranslate"><span class="pre">df.word</span></code> e talvolta la sintassi <code class="docutils literal notranslate"><span class="pre">df.word()</span></code>. Tecnicamente, la classe Pandas Dataframe ha sia attributi che metodi. Gli attributi sono <code class="docutils literal notranslate"><span class="pre">.word</span></code>, mentre i metodi sono <code class="docutils literal notranslate"><span class="pre">.word()</span></code> o <code class="docutils literal notranslate"><span class="pre">.word(arg1,</span> <span class="pre">arg2,</span> <span class="pre">ecc.)</span></code>. Per sapere se qualcosa è un metodo o un attributo è necessario leggere la documentazione.</p>
</div>
<p>Abbiamo visto in precedenza come possiamo leggere i dati in un dataframe utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code>. Pandas comprende anche molti altri formati, ad esempio utilizzando le funzioni <code class="docutils literal notranslate"><span class="pre">read_excel()</span></code>, <code class="docutils literal notranslate"><span class="pre">read_hdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">read_json()</span></code>, ecc. (e i corrispondenti metodi per scrivere su file: <code class="docutils literal notranslate"><span class="pre">to_csv()</span></code>, <code class="docutils literal notranslate"><span class="pre">to_excel()</span></code>, <code class="docutils literal notranslate"><span class="pre">to_hdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">to_json()</span></code>, ecc.).</p>
</section>
<section id="gestione-dei-dati-mancanti">
<h2><span class="section-number">5.4. </span>Gestione dei dati mancanti<a class="headerlink" href="#gestione-dei-dati-mancanti" title="Permalink to this headline">#</a></h2>
<p>Nell’output di <code class="docutils literal notranslate"><span class="pre">.info()</span></code> troviamo la colonna “Non-Null Count”, ovvero il numero di dati non mancanti per ciascuna colonna del DataFrame. Da questo si nota che le colonne del DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code> contengono alcuni dati mancanti. La gestione dei dati mancanti è un argomento complesso. Per ora ci limitiamo ad escludere tutte le righe che, in qualche colonna, contengono dei dati mancanti.</p>
<p>Ottengo il numero di dati per ciascuna colonna del DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>species               0
island                0
bill_length_mm        2
bill_depth_mm         2
flipper_length_mm     2
body_mass_g           2
sex                  11
year                  0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Rimuovo i dati mancanti con il metodo <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>. L’argomento <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> specifica il DataFrame viene trasformato in maniera permanente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Verifico che i dati mancanti siano stati rimossi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(333, 8)
</pre></div>
</div>
</div>
</div>
</section>
<section id="rinominare-le-colonne">
<h2><span class="section-number">5.5. </span>Rinominare le colonne<a class="headerlink" href="#rinominare-le-colonne" title="Permalink to this headline">#</a></h2>
<p>È possibile rinominare tutte le colonne passando al metodo <code class="docutils literal notranslate"><span class="pre">.rename()</span></code> un dizionario che specifica quali colonne devono essere mappate a cosa. Nella cella seguente faccio prima una copia del DataFrame con il metodo <code class="docutils literal notranslate"><span class="pre">copy()</span></code> e poi rinomino <code class="docutils literal notranslate"><span class="pre">sex</span></code> che diventa <code class="docutils literal notranslate"><span class="pre">gender</span></code> e <code class="docutils literal notranslate"><span class="pre">year</span></code> che diventa <code class="docutils literal notranslate"><span class="pre">year_of_the_study</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># rename(columns={&quot;OLD_NAME&quot;: &quot;NEW_NAME&quot;})</span>
<span class="n">df1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;year_of_the_study&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>gender</th>
      <th>year_of_the_study</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Si noti che in Python valgono le seguenti regole.</p>
<ul class="simple">
<li><p>Il nome di una variabile deve iniziare con una lettera o con il trattino basso (<em>underscore</em>) <code class="docutils literal notranslate"><span class="pre">_</span></code>.</p></li>
<li><p>Il nome di una variabile non può iniziare con un numero.</p></li>
<li><p>Un nome di variabile può contenere solo caratteri alfanumerici e il trattino basso (A-z, 0-9 e _).</p></li>
<li><p>I nomi delle variabili fanno distinzione tra maiuscole e minuscole (<code class="docutils literal notranslate"><span class="pre">age</span></code>, <code class="docutils literal notranslate"><span class="pre">Age</span></code> e <code class="docutils literal notranslate"><span class="pre">AGE</span></code> sono tre variabili diverse).</p></li>
</ul>
<p>Gli spazi non sono consentiti nel nome delle variabili: come separatore usate il trattino basso.</p>
</div>
</section>
<section id="estrarre-i-dati-dal-dataframe">
<h2><span class="section-number">5.6. </span>Estrarre i dati dal DataFrame<a class="headerlink" href="#estrarre-i-dati-dal-dataframe" title="Permalink to this headline">#</a></h2>
<p>Una parte cruciale del lavoro con i DataFrame è l’estrazione di sottoinsiemi di dati: vogliamo trovare le righe che soddisfano un determinato insieme di criteri, vogliamo isolare le colonne/righe di interesse, ecc. Per rispondere alle domande di interesse dell’analisi dei dati, molto spesso è necessario selezionare un sottoinsieme del DataFrame.</p>
<section id="colonne">
<h3><span class="section-number">5.6.1. </span>Colonne<a class="headerlink" href="#colonne" title="Permalink to this headline">#</a></h3>
<p>È possibile estrarre una colonna da un DataFrame usando una notazione simile a quella che si usa per il dizionario (<code class="docutils literal notranslate"><span class="pre">DataFrame['word']</span></code>) o utilizzando la notazione <code class="docutils literal notranslate"><span class="pre">DataFrame.word</span></code>. Per esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      39.1
1      39.5
2      40.3
4      36.7
5      39.3
       ... 
339    55.8
340    43.5
341    49.6
342    50.8
343    50.2
Name: bill_length_mm, Length: 333, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">bill_length_mm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      39.1
1      39.5
2      40.3
4      36.7
5      39.3
       ... 
339    55.8
340    43.5
341    49.6
342    50.8
343    50.2
Name: bill_length_mm, Length: 333, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Se tra parentesi quadre indichiamo una lista di colonne come <code class="docutils literal notranslate"><span class="pre">df[['bill_length_mm','species']]</span></code> otteniamo un nuovo DataFrame costituito da queste colonne:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;species&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39.1</td>
      <td>Adelie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39.5</td>
      <td>Adelie</td>
    </tr>
    <tr>
      <th>2</th>
      <td>40.3</td>
      <td>Adelie</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36.7</td>
      <td>Adelie</td>
    </tr>
    <tr>
      <th>5</th>
      <td>39.3</td>
      <td>Adelie</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>55.8</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>43.5</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>49.6</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>50.8</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>50.2</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>333 rows × 2 columns</p>
</div></div></div>
</div>
</section>
<section id="righe">
<h3><span class="section-number">5.6.2. </span>Righe<a class="headerlink" href="#righe" title="Permalink to this headline">#</a></h3>
<p>In un <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, anche le righe hanno un nome. I nomi delle righe sono chiamati <code class="docutils literal notranslate"><span class="pre">index</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([  0,   1,   2,   4,   5,   6,   7,  12,  13,  14,
            ...
            334, 335, 336, 337, 338, 339, 340, 341, 342, 343],
           dtype=&#39;int64&#39;, length=333)
</pre></div>
</div>
</div>
</div>
<p>Ci sono vari metodi per estrarre sottoinsimi di righe da un DataFrame. È possibile fare riferimento ad un intervallo di righe mediante un indice di <code class="docutils literal notranslate"><span class="pre">slice</span></code>. Per esempio, possiamo ottenere le prime 3 righe del DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code> nel modo seguente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si noti che in Python una sequenza è determinata dal valore iniziale e quello finale <em>ma si interrompe ad n-1</em>. Pertanto, per selezionare una singola riga (per esempio, la prima) dobbiamo procedere nel modo seguente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="indicizzazione-selezione-e-filtraggio">
<h3><span class="section-number">5.6.3. </span>Indicizzazione, selezione e filtraggio<a class="headerlink" href="#indicizzazione-selezione-e-filtraggio" title="Permalink to this headline">#</a></h3>
<p>Poiché l’oggetto DataFrame è bidimensionale, è possibile selezionare un sottoinsieme di righe e colonne utilizzando le etichette degli assi (<code class="docutils literal notranslate"><span class="pre">loc</span></code>) o gli indici delle righe (<code class="docutils literal notranslate"><span class="pre">iloc</span></code>).</p>
<p>Per esempio, usando l’attributo <code class="docutils literal notranslate"><span class="pre">iloc</span></code> posso selezionare la prima riga del DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>species                 Adelie
island               Torgersen
bill_length_mm            39.1
bill_depth_mm             18.7
flipper_length_mm        181.0
body_mass_g             3750.0
sex                       male
year                      2007
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<p>La cella seguene seleziona le prime tre righe del DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>L’attributo <code class="docutils literal notranslate"><span class="pre">loc</span></code> consente di selezionare simultaneamente righe e colonne per “nome”. Il “nome” delle righe è l’indice di riga. Per esempio, visualizzo il quinto valore della colonna <code class="docutils literal notranslate"><span class="pre">body_mass_g</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3450.0
</pre></div>
</div>
</div>
</div>
<p>oppure, il quinto valore delle colonne <code class="docutils literal notranslate"><span class="pre">bill_length_mm</span></code>, <code class="docutils literal notranslate"><span class="pre">bill_depth_mm</span></code>, <code class="docutils literal notranslate"><span class="pre">flipper_length_mm</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">]]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bill_length_mm        36.7
bill_depth_mm         19.3
flipper_length_mm    193.0
Name: 4, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Visualizzo ora le prime tre righe sulle tre colonne precedenti. Si noti l’uso di <code class="docutils literal notranslate"><span class="pre">:</span></code> per definire un intervallo di valori sull’indice di riga.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Una piccola variante della sintassi precedente si rivela molto utile. Qui, il segno di due punti (<code class="docutils literal notranslate"><span class="pre">:</span></code>) signfica “tutte le righe”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">keep_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">keep_cols</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     bill_length_mm  bill_depth_mm  flipper_length_mm
0              39.1           18.7              181.0
1              39.5           17.4              186.0
2              40.3           18.0              195.0
4              36.7           19.3              193.0
5              39.3           20.6              190.0
..              ...            ...                ...
339            55.8           19.8              207.0
340            43.5           18.1              202.0
341            49.6           18.2              193.0
342            50.8           19.0              210.0
343            50.2           18.7              198.0

[333 rows x 3 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="filtrare-righe-in-maniera-condizionale">
<h3><span class="section-number">5.6.4. </span>Filtrare righe in maniera condizionale<a class="headerlink" href="#filtrare-righe-in-maniera-condizionale" title="Permalink to this headline">#</a></h3>
<p>In precedenza abbiamo utilizzato la selezione delle righe in un DataFrame in base alla loro posizione. Tuttavia, è più comune selezionare le righe del DataFrame utilizzando una condizione logica, cioè tramite l’indicizzazione booleana.</p>
<p>Iniziamo con un esempio relativo ad una condizione specificata sui valori di una sola colonna. Quando applichiamo un operatore logico come &gt;, &lt;, ==, != ai valori di una colonna del DataFrame, il risultato è una sequenza di valori booleani (<code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">False</span></code>), uno per ogni riga nel DataFrame, i quali indicano se, per quella riga, la condizione è vera o falsa. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Torgersen&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       True
1       True
2       True
4       True
5       True
       ...  
339    False
340    False
341    False
342    False
343    False
Name: island, Length: 333, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Utilizzando i valori booleani che sono stati ottenuti in questo modo è possibile filtrare le righe del DataFrame, ovvero, ottenere un nuovo DataFrame nel quale la condizione logica specificata è vera su tutte le righe. Per esempio, nella cella seguente selezioniamo solo le osservazioni relative all’isola Torgersen, ovvero tutte le righe del DataFrame nelle quali la colonna <code class="docutils literal notranslate"><span class="pre">island</span></code> assume il valore <code class="docutils literal notranslate"><span class="pre">Torgersen</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">only_torgersen</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Torgersen&quot;</span><span class="p">]</span>
<span class="n">only_torgersen</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In maniera equivalente, possiamo scrivere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">only_torgersen</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Torgersen&quot;</span><span class="p">]</span>
<span class="n">only_torgersen</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>È possibile combinare più condizioni logiche usando gli operatori <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (e), <code class="docutils literal notranslate"><span class="pre">|</span></code> (oppure). Si presti attenzione all’uso delle parentesi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Torgersen&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;female&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>38.9</td>
      <td>17.8</td>
      <td>181.0</td>
      <td>3625.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>41.1</td>
      <td>17.6</td>
      <td>182.0</td>
      <td>3200.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="metodo-query">
<h3><span class="section-number">5.6.5. </span>Metodo <code class="docutils literal notranslate"><span class="pre">.query</span></code><a class="headerlink" href="#metodo-query" title="Permalink to this headline">#</a></h3>
<p>È anche possibile filtrare le righe del DataFrame usando il metodo <code class="docutils literal notranslate"><span class="pre">query()</span></code>. Ci sono diversi modi per generare sottoinsiemi con Pandas. I metodi <code class="docutils literal notranslate"><span class="pre">loc</span></code> e <code class="docutils literal notranslate"><span class="pre">iloc</span></code> consentono di recuperare sottoinsiemi in base alle etichette di riga e colonna o all’indice intero delle righe e delle colonne. E Pandas ha una notazione a parentesi quadre che consente di utilizzare condizioni logiche per recuperare righe di dati specifiche. Ma la sintassi di questi metodi non è la più trasparente. Inoltre, tali metodi sono difficili da usare insieme ad altri metodi di manipolazione dei dati in modo organico.</p>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">.query</span></code> di Pandas cerca di risolve questi problemi. Il metodo <code class="docutils literal notranslate"><span class="pre">.query</span></code> consente di “interrogare” un DataFrame e recuperare sottoinsiemi basati su condizioni logiche. La sintassi è un po’ più snella rispetto alla notazione a parentesi quadre di Pandas. Inoltre, il metodo <code class="docutils literal notranslate"><span class="pre">.query</span></code> può essere utilizzato con altri metodi di Pandas in modo snello e semplice, rendendo la manipolazione dei dati maggiormente fluida e diretta.</p>
<p>La sintassi è la seguente:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">your_data_frame</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>L’espressione utilizzata nella query è una sorta di espressione logica che descrive quali righe restituire in output. Se l’espressione è vera per una particolare riga, la riga verrà inclusa nell’output. Se l’espressione è falsa per una particolare riga, quella riga verrà esclusa dall’output.</p>
<p>Il parametro inplace consente di specificare se si desidera modificare direttamente il DataFrame con cui si sta lavorando.</p>
<p>Per esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_string</span> <span class="o">=</span> <span class="s2">&quot;island == &#39;Torgersen&#39; &amp; sex == &#39;female&#39; &amp; year != 2009&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">eval_string</span><span class="p">)[[</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>17.4</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19.3</td>
      <td>193.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17.8</td>
      <td>181.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>17.6</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>17.8</td>
      <td>185.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>19.0</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18.4</td>
      <td>184.0</td>
    </tr>
    <tr>
      <th>68</th>
      <td>16.6</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>70</th>
      <td>19.0</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>72</th>
      <td>17.2</td>
      <td>196.0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>17.5</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>16.8</td>
      <td>191.0</td>
    </tr>
    <tr>
      <th>78</th>
      <td>16.1</td>
      <td>187.0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>17.2</td>
      <td>189.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>18.8</td>
      <td>187.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Un altro esempio usa la keyword <code class="docutils literal notranslate"><span class="pre">in</span></code> per selezionare solo le righe relative alle due isole specificate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_string</span> <span class="o">=</span> <span class="s2">&quot;island in [&#39;Torgersen&#39;, &#39;Dream&#39;]&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">eval_string</span><span class="p">)[[</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.7</td>
      <td>181.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17.4</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19.3</td>
      <td>193.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>20.6</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>19.8</td>
      <td>207.0</td>
    </tr>
    <tr>
      <th>340</th>
      <td>18.1</td>
      <td>202.0</td>
    </tr>
    <tr>
      <th>341</th>
      <td>18.2</td>
      <td>193.0</td>
    </tr>
    <tr>
      <th>342</th>
      <td>19.0</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>343</th>
      <td>18.7</td>
      <td>198.0</td>
    </tr>
  </tbody>
</table>
<p>170 rows × 2 columns</p>
</div></div></div>
</div>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">query()</span></code> può anche essere utilizzato per selezionare le righe di un DataFrame in base alle relazioni tra le colonne. Ad esempio,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;bill_length_mm &gt; 3*bill_depth_mm&quot;</span><span class="p">)[[</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>13.2</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>153</th>
      <td>16.3</td>
      <td>230.0</td>
    </tr>
    <tr>
      <th>154</th>
      <td>14.1</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>155</th>
      <td>15.2</td>
      <td>218.0</td>
    </tr>
    <tr>
      <th>156</th>
      <td>14.5</td>
      <td>215.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>272</th>
      <td>14.3</td>
      <td>215.0</td>
    </tr>
    <tr>
      <th>273</th>
      <td>15.7</td>
      <td>222.0</td>
    </tr>
    <tr>
      <th>274</th>
      <td>14.8</td>
      <td>212.0</td>
    </tr>
    <tr>
      <th>275</th>
      <td>16.1</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>293</th>
      <td>17.8</td>
      <td>181.0</td>
    </tr>
  </tbody>
</table>
<p>106 rows × 2 columns</p>
</div></div></div>
</div>
<p>È anche possibile fare riferimento a variabili non contenute nel DataFrame usando il carattere <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outside_var</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;bill_depth_mm &gt; @outside_var&quot;</span><span class="p">)[[</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>21.2</td>
      <td>191.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>21.1</td>
      <td>198.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>21.5</td>
      <td>194.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>21.1</td>
      <td>196.0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>21.2</td>
      <td>191.0</td>
    </tr>
    <tr>
      <th>61</th>
      <td>21.1</td>
      <td>195.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="selezione-casuale-di-un-sottoinsieme-di-righe">
<h2><span class="section-number">5.7. </span>Selezione casuale di un sottoinsieme di righe<a class="headerlink" href="#selezione-casuale-di-un-sottoinsieme-di-righe" title="Permalink to this headline">#</a></h2>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">sample()</span></code> viene usato per ottenere un sottoinsieme casuale di righe del DataFrame. L’argomento <code class="docutils literal notranslate"><span class="pre">replace=False</span></code> indica l’estrazione senza rimessa (default); se specifichiamo <code class="docutils literal notranslate"><span class="pre">replace=True</span></code> otteniamo un’estrazione con rimessa. L’argomento <code class="docutils literal notranslate"><span class="pre">n</span></code> specifica il numero di righe che vogliamo ottenere. Ad esempio</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">df_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>191</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>48.7</td>
      <td>15.7</td>
      <td>208.0</td>
      <td>5350.0</td>
      <td>male</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>241</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>52.1</td>
      <td>17.0</td>
      <td>230.0</td>
      <td>5550.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.3</td>
      <td>13.8</td>
      <td>208.0</td>
      <td>4200.0</td>
      <td>female</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>304</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>46.4</td>
      <td>17.8</td>
      <td>191.0</td>
      <td>3700.0</td>
      <td>female</td>
      <td>2008</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">df_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>37.0</td>
      <td>16.9</td>
    </tr>
    <tr>
      <th>142</th>
      <td>32.1</td>
      <td>15.5</td>
    </tr>
    <tr>
      <th>243</th>
      <td>52.2</td>
      <td>17.1</td>
    </tr>
    <tr>
      <th>207</th>
      <td>45.0</td>
      <td>15.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="selezione-di-colonne">
<h2><span class="section-number">5.8. </span>Selezione di colonne<a class="headerlink" href="#selezione-di-colonne" title="Permalink to this headline">#</a></h2>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">drop()</span></code> prende in input una lista con i nomi di colonne che vogliamo escludere dal DataFrame e può essere usato per creare un nuovo DataFrame o per sovrascrivere quello di partenza. È possibile usare le espressioni regolari (<em>regex</em>) per semplificare la ricerca dei nomi delle colonne.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In <em>regex</em> il simbolo <code class="docutils literal notranslate"><span class="pre">$</span></code> significa “la stringa finisce con”; il simbolo <code class="docutils literal notranslate"><span class="pre">^</span></code> significa “la stringa inizia con”. L’espressione <code class="docutils literal notranslate"><span class="pre">regex</span></code> può contenere (senza spazi) il simbolo <code class="docutils literal notranslate"><span class="pre">|</span></code> che significa “oppure”.</p>
</div>
<p>Nel codice della cella seguente, alla funzione <code class="docutils literal notranslate"><span class="pre">.columns.str.contains()</span></code> viene passata l’espressione regolare <code class="docutils literal notranslate"><span class="pre">mm$|year</span></code> che significa: tutte le stringhe (in questo caso, nomi di colonne) che finiscono con <code class="docutils literal notranslate"><span class="pre">mm</span></code> oppure la stringa (nome di colonna) <code class="docutils literal notranslate"><span class="pre">year</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;mm$|year&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">columns_to_drop</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">columns_to_drop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;bill_length_mm&#39;, &#39;bill_depth_mm&#39;, &#39;flipper_length_mm&#39;, &#39;year&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns_to_drop</span><span class="p">)</span>
<span class="n">df_new</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3750.0</td>
      <td>male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3800.0</td>
      <td>female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3250.0</td>
      <td>female</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3450.0</td>
      <td>female</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3650.0</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In un altro esempio, creaiamo l’elenco delle colonne che iniziano con la lettera “b”, insieme a <code class="docutils literal notranslate"><span class="pre">year</span></code> e <code class="docutils literal notranslate"><span class="pre">sex</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;^b|year|sex&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">columns_to_drop</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">columns_to_drop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;bill_length_mm&#39;, &#39;bill_depth_mm&#39;, &#39;body_mass_g&#39;, &#39;sex&#39;, &#39;year&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Oppure l’elenco delle colonne che contengono il patten “length”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">)</span>
<span class="n">columns_to_drop</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">columns_to_drop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;bill_length_mm&#39;, &#39;flipper_length_mm&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="creare-nuove-colonne">
<h2><span class="section-number">5.9. </span>Creare nuove colonne<a class="headerlink" href="#creare-nuove-colonne" title="Permalink to this headline">#</a></h2>
<p>Per ciascuna riga, calcoliamo</p>
<ul class="simple">
<li><p>bill_length_mm - bill_depth_mm</p></li>
<li><p>bill_length_mm / (body_mass_g / 1000)</p></li>
</ul>
<p>Per ottenere questo risultato possiamo usare una <em>lambda function</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">bill_difference</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">bill_length_mm</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">bill_depth_mm</span><span class="p">,</span>
    <span class="n">bill_ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">bill_length_mm</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">body_mass_g</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
      <th>bill_difference</th>
      <th>bill_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
      <td>20.4</td>
      <td>10.426667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
      <td>22.1</td>
      <td>10.394737</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
      <td>22.3</td>
      <td>12.400000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
      <td>17.4</td>
      <td>10.637681</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
      <td>18.7</td>
      <td>10.767123</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In maniera più semplice possiamo procedere nel modo seguente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;bill_ratio2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;body_mass_g&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
      <th>bill_difference</th>
      <th>bill_ratio</th>
      <th>bill_ratio2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
      <td>20.4</td>
      <td>10.426667</td>
      <td>10.426667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
      <td>22.1</td>
      <td>10.394737</td>
      <td>10.394737</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
      <td>22.3</td>
      <td>12.400000</td>
      <td>12.400000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
      <td>17.4</td>
      <td>10.637681</td>
      <td>10.637681</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
      <td>18.7</td>
      <td>10.767123</td>
      <td>10.767123</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Un’utile funzionalità è quella che consente di aggiungere una colonna ad un DataFrame (o di mofificare una colonna già esistente) sulla base di una condizione True/False. Questo risultato può essere raggiunto usando <code class="docutils literal notranslate"><span class="pre">np.where()</span></code>, con la seguente sintassi:</p>
<p><code class="docutils literal notranslate"><span class="pre">np.where(condition,</span> <span class="pre">value</span> <span class="pre">if</span> <span class="pre">condition</span> <span class="pre">is</span> <span class="pre">true,</span> <span class="pre">value</span> <span class="pre">if</span> <span class="pre">condition</span> <span class="pre">is</span> <span class="pre">false)</span></code></p>
<p>Supponiamo di avere un DataFrame df con due colonne, <code class="docutils literal notranslate"><span class="pre">A</span></code> e <code class="docutils literal notranslate"><span class="pre">B</span></code>, e vogliamo creare una nuova colonna <code class="docutils literal notranslate"><span class="pre">C</span></code> che contenga il valore di <code class="docutils literal notranslate"><span class="pre">A</span></code> quando questo è maggiore di 0, e il valore di <code class="docutils literal notranslate"><span class="pre">B</span></code> altrimenti. Possiamo utilizzare la funzione <code class="docutils literal notranslate"><span class="pre">where()</span></code> per ottenere ciò come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creiamo un DataFrame di esempio</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">]})</span>

<span class="c1"># Creiamo una nuova colonna &#39;C&#39; usando la funzione where()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   A  B  C
0 -1  5  5
1  2  6  2
2  3  0  3
3 -4  8  8
</pre></div>
</div>
</div>
</div>
</section>
<section id="formato-long-e-wide">
<h2><span class="section-number">5.10. </span>Formato long e wide<a class="headerlink" href="#formato-long-e-wide" title="Permalink to this headline">#</a></h2>
<p>Nella data analysis, i termini “formato long” e “formato wide” sono usati per descrivere la struttura di un set di dati. l formato wide (in inglese “wide format”) rappresenta una struttura di dati in cui ogni riga rappresenta una singola osservazione e ogni variabile è rappresentata da più colonne. Un esempio è il seguente, nel quale per ciascun partecipante, identificato da <code class="docutils literal notranslate"><span class="pre">Name</span></code> e <code class="docutils literal notranslate"><span class="pre">ID</span></code> abbiamo i punteggi di un ipotetico test per 6 anni consecutivi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Maria&quot;</span><span class="p">,</span> <span class="s2">&quot;Carlo&quot;</span><span class="p">,</span> <span class="s2">&quot;Giovanna&quot;</span><span class="p">,</span> <span class="s2">&quot;Irene&quot;</span><span class="p">],</span>
    <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="s2">&quot;2017&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">91</span><span class="p">],</span>
    <span class="s2">&quot;2018&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">96</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
    <span class="s2">&quot;2019&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">106</span><span class="p">],</span>
    <span class="s2">&quot;2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">89</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s2">&quot;2021&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">94</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s2">&quot;2022&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">107</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">wide_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
<span class="n">wide_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>ID</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
      <th>2021</th>
      <th>2022</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Maria</td>
      <td>1</td>
      <td>85</td>
      <td>96</td>
      <td>100</td>
      <td>89</td>
      <td>94</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Carlo</td>
      <td>2</td>
      <td>87</td>
      <td>98</td>
      <td>102</td>
      <td>95</td>
      <td>96</td>
      <td>104</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>89</td>
      <td>100</td>
      <td>106</td>
      <td>98</td>
      <td>98</td>
      <td>104</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Irene</td>
      <td>4</td>
      <td>91</td>
      <td>102</td>
      <td>106</td>
      <td>100</td>
      <td>100</td>
      <td>107</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il formato long (in inglese “long format”) rappresenta una struttura di dati in cui ogni riga rappresenta una singola osservazione e ogni colonna rappresenta una singola variabile. Questo formato è quello che viene richiesto per molte analisi statistiche. In Pandas è possibile usare la funzione <code class="docutils literal notranslate"><span class="pre">melt</span></code> per trasformare i dati dal formato wide al formato long. Un esempio è riportato qui sotto. Sono state mantenute le due colonne che identificano ciascun partecipante, ma i dati del test, che prima erano distribuiti su sei colonne, ora sono presenti in una singola colonna. Al DataFrame, inoltre, è stata aggiunta una colonna che riporta l’anno.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span> <span class="o">=</span> <span class="n">wide_data</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Score&quot;</span>
<span class="p">)</span>
<span class="n">long_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>ID</th>
      <th>Year</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Maria</td>
      <td>1</td>
      <td>2017</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2017</td>
      <td>87</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2017</td>
      <td>89</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Irene</td>
      <td>4</td>
      <td>2017</td>
      <td>91</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>1</td>
      <td>2018</td>
      <td>96</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2018</td>
      <td>98</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2018</td>
      <td>100</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Irene</td>
      <td>4</td>
      <td>2018</td>
      <td>102</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Maria</td>
      <td>1</td>
      <td>2019</td>
      <td>100</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2019</td>
      <td>102</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2019</td>
      <td>106</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Irene</td>
      <td>4</td>
      <td>2019</td>
      <td>106</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Maria</td>
      <td>1</td>
      <td>2020</td>
      <td>89</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2020</td>
      <td>95</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2020</td>
      <td>98</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Irene</td>
      <td>4</td>
      <td>2020</td>
      <td>100</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Maria</td>
      <td>1</td>
      <td>2021</td>
      <td>94</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2021</td>
      <td>96</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2021</td>
      <td>98</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Irene</td>
      <td>4</td>
      <td>2021</td>
      <td>100</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Maria</td>
      <td>1</td>
      <td>2022</td>
      <td>100</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2022</td>
      <td>104</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2022</td>
      <td>104</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Irene</td>
      <td>4</td>
      <td>2022</td>
      <td>107</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Per migliorare la leggibilità dei dati, è possibile riordinare le righe del set di dati utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">sort_values</span></code>. In questo modo, le informazioni saranno presentate in un ordine specifico, che può rendere più facile la lettura dei dati.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>ID</th>
      <th>Year</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Maria</td>
      <td>1</td>
      <td>2017</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Maria</td>
      <td>1</td>
      <td>2018</td>
      <td>96</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Maria</td>
      <td>1</td>
      <td>2019</td>
      <td>100</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Maria</td>
      <td>1</td>
      <td>2020</td>
      <td>89</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Maria</td>
      <td>1</td>
      <td>2021</td>
      <td>94</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Maria</td>
      <td>1</td>
      <td>2022</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2017</td>
      <td>87</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2018</td>
      <td>98</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2019</td>
      <td>102</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2020</td>
      <td>95</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2021</td>
      <td>96</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Carlo</td>
      <td>2</td>
      <td>2022</td>
      <td>104</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2017</td>
      <td>89</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2018</td>
      <td>100</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2019</td>
      <td>106</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2020</td>
      <td>98</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2021</td>
      <td>98</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Giovanna</td>
      <td>3</td>
      <td>2022</td>
      <td>104</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Irene</td>
      <td>4</td>
      <td>2017</td>
      <td>91</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Irene</td>
      <td>4</td>
      <td>2018</td>
      <td>102</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Irene</td>
      <td>4</td>
      <td>2019</td>
      <td>106</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Irene</td>
      <td>4</td>
      <td>2020</td>
      <td>100</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Irene</td>
      <td>4</td>
      <td>2021</td>
      <td>100</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Irene</td>
      <td>4</td>
      <td>2022</td>
      <td>107</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="watermark">
<h2><span class="section-number">5.11. </span>Watermark<a class="headerlink" href="#watermark" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -n -u -v -iv -w
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Last updated: Mon May 29 2023

Python implementation: CPython
Python version       : 3.11.3
IPython version      : 8.13.2

pandas: 1.5.3
numpy : 1.23.5

Watermark: 2.3.1
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="020_intro_numpy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Introduzione a Numpy</p>
      </div>
    </a>
    <a class="right-next"
       href="026_pandas_aggregate.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Riepilogo dei dati con Pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">5.1. Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">5.2. DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lettura-di-dati-da-file">5.3. Lettura di dati da file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gestione-dei-dati-mancanti">5.4. Gestione dei dati mancanti</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rinominare-le-colonne">5.5. Rinominare le colonne</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estrarre-i-dati-dal-dataframe">5.6. Estrarre i dati dal DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colonne">5.6.1. Colonne</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#righe">5.6.2. Righe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indicizzazione-selezione-e-filtraggio">5.6.3. Indicizzazione, selezione e filtraggio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrare-righe-in-maniera-condizionale">5.6.4. Filtrare righe in maniera condizionale</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-query">5.6.5. Metodo <code class="docutils literal notranslate"><span class="pre">.query</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selezione-casuale-di-un-sottoinsieme-di-righe">5.7. Selezione casuale di un sottoinsieme di righe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selezione-di-colonne">5.8. Selezione di colonne</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creare-nuove-colonne">5.9. Creare nuove colonne</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formato-long-e-wide">5.10. Formato long e wide</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#watermark">5.11. Watermark</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Corrado Caudek
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>